# YellowDiagnostician

Экспериментальная внешняя компонента для платформы 1С:Предприятие 8.x с некоторыми функциями для расширенной диагностики работы как самой платформы, так и ее работы с конкретным окружением.

## Поддерживаемые системы

* Windows 32 и 64 бит

## Предупреждение

Внимание!!!
Компонента экспериментальная и создавалась для конкретных целей.
Использование на Вашей ответственности, совести.

## API

Компонента имеет список методов для получения дополнительной информации. Некоторую из них можно получить в каком-либо виде средствами платформы 1С.

Компонента может использоваться как на клиенте, так и на сервере.

### Список методов

<b>GetDomainName (ПолучитьИмяДомена)</b> - получает имя домена, доступное в контексте приложения.

Возвращаемое значение:

- Строка. Имя домена.

<b>GetUserName (ПолучитьИмяПользователя)</b> - получает имя пользователя, от имени которого запущено приложение.

Возвращаемое значение:

- Строка. Имя пользователя.

<b>GetHostName (ПолучитьИмяКомпьютера)</b> - получает имя компьютера, на котором запущено приложение.

Возвращаемое значение:

- Строка. Имя компьютера.

<b>GetProcessName (ПолучитьИмяПроцесса)</b> - получает полное имя процесса (путь до исполняемого файла).

Возвращаемое значение:

- Строка. Полное имя к исполняемому файлу процесса.

<b>GetProcessId (ПолучитьИдентификаторПроцесса)</b> - получает числовой идентификатор текущего процесса.

Возвращаемое значение:

- Целое число. Числовой идентификатор процесса.

<b>GetThreadId (ПолучитьИдентификаторПотока)</b> - получает числовой идентификатор текущего потока.

Возвращаемое значение:

- Целое число. Числовой идентификатор потока.

## Пример работы с компонентой

На первом этапе инициализируем компоненту из общего макета конфигурации "yy_YellowDiagnostician" (но Вы можете сохранить ее в любое другое подходящее место):

``` bsl
Функция СоздатьОбъектКомпоненты() Экспорт
	
	Попытка
		
		ИмяКомпоненты = "ОбщийМакет.yy_YellowDiagnostician";
		
		#Если Клиент Тогда
		УстановитьВнешнююКомпоненту(ИмяКомпоненты);
		#КонецЕсли
		
		Результат = ПодключитьВнешнююКомпоненту(ИмяКомпоненты, "YY", ТипВнешнейКомпоненты.Native);
		Если Результат = Ложь Тогда
			ВызватьИсключение "Не удалось создать объект компоненты """ + ИмяКомпоненты + """";
		КонецЕсли;
		
		ОбъектВК = Новый("AddIn.YY.YellowDiagnostician");		
		Возврат ОбъектВК;
		
	Исключение
		
		ВызватьИсключение "Ошибка при инициализации компоненты: "
			+ Символы.ПС
			+ ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
		
	КонецПопытки;	
	
КонецФункции
```

Далее вызываем необходимые методы:

``` bsl
Компонента = СоздатьОбъектКомпоненты();

ИмяКомпьютера = Компонента.ПолучитьИмяКомпьютера();
ИмяПользователя = Компонента.ПолучитьИмяПользователя();
ИдентификаторПотока = Компонента.ПолучитьИдентификаторПотока();
ИдентификаторПроцесса = Компонента.ПолучитьИдентификаторПроцесса();
ИмяПроцесса = Компонента.ПолучитьИмяПроцесса();
ИмяДомена = Компонента.ПолучитьИмяДомена();
```
Пока что все :)

## Сборка проекта через Visual Studio для Windows

1. Запустить проект [YY.YellowDiagnostician](YY.YellowDiagnostician.sln) 
2. Скомпилировать проект через f5
3. Profit! :)

## TODO

* Добавить версию для Linux
* Добавить поддержку CMake
* Расширить набор методов компоненты в части:
  * Дополнительная диагностика процессов и потоков
  * Создание потоков и их завершение
  * Информация по использованной памятью процессом
  * Проверка окружения

## Лицензия

MIT - делайте все, что посчитаете нужным. Никакой гарантии и никаких ограничений по использованию.
